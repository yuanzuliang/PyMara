<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>ç®¡ç†åšå®¢</title>
    <link rel="stylesheet" href="../../static/blog/management/css/bootstrap.min.css">
    <script src="../../static/blog/management/js/jquery.min.js"></script>
    <script src="../../static/blog/management/js/bootstrap.min.js"></script>
    <link rel="stylesheet" href="../../static/blog/management/css/management.css">
    <script src="../../static/tools/js/settings.js"></script>
    <script src="../../static/blog/management/js/sweetalert2.js"></script>
    <link rel="stylesheet" href="../../static/blog/management/css/sweetalert2.min.css">
    <script src="../../static/tools/js/tools.js"></script>

</head>
<body>
<nav>
    <div class="d_top">
        <div class="d_right">
            <div class="right_top">
                <div class="btn-group btn_list" role="group" aria-label="...">
                    <button type="button" class="btn btn-default" id="quanbu">å…¨éƒ¨<i class="all">0</i></button>
                    <button type="button" class="btn btn-default" id="gongkai">å…¬å¼€<i class="all">0</i></button>
                    <button type="button" class="btn btn-default" id="simi">ç§å¯†<i class="all">0</i></button>
                    <button type="button" class="btn btn-default" id="caogao">è‰ç¨¿ç®±<i class="all">0</i></button>
                    <button type="button" class="btn btn-default" id="huishou">å›æ”¶ç«™<i class="all">0</i></button>
                </div>
            </div>
            <div class="d_screening">
                <div class="d1">
                    ç­›é€‰ï¼š
                    <select name="year-select">
                        <option value="2018">2018</option>
                        <option value="2019">2019</option>
                        <option value="2020">2020</option>
                    </select>
                    <span>å¹´</span>
                    <select name="mouth-select">
                        <option value="1">1</option>
                        <option value="2">2</option>
                        <option value="3">3</option>
                        <option value="4">4</option>
                        <option value="5">5</option>
                    </select>
                    <span>æœˆ</span>
                </div>
                <div class="d3">
                    <select name="article-type">
                        <option value="1">æ–‡ç« ç±»å‹</option>
                        <option value="2">ä¸é™ç±»å‹</option>
                        <option value="3">åŸåˆ›</option>
                        <option value="4">è½¬è½½</option>
                        <option value="5">ç¿»è¯‘</option>
                    </select>
                </div>
                <div class="d4">
                    <select name="classification">
                        <option value="1">åˆ†ç±»ä¸“æ </option>
                        <option value="2">ä¸é™</option>
                    </select>
                </div>
                <div class="d5">
                    <form class="navbar-form navbar-left" role="search">
                        <div class="form-group">
                            <input id="shuru" type="text" class="form-control" placeholder="è¯·è¾“å…¥å…³é”®å­—">
                        </div>
                        <button type="submit" class="btn-sosuo btn-default">æœç´¢ğŸ”</button>
                    </form>
                </div>

            </div>
            <div class="father">
                <div class="edit">å¿«æ¥å‘å¸ƒç¬¬ä¸€ç¯‡åšå®¢å§!</div>
            </div>
        </div>
        <a href="../blog/forms.html">
            <button type="button" class="btn-editor btn btn-default btn1  edit">
                å¯Œæ–‡æœ¬ç¼–è¾‘å™¨
            </button>
        </a>
    </div>
    <div class="navigation">
        <div class="btn-group">
            <p class="home_page">
                <button id="btn_page" type="button" class="btn-lg btn btn-link glyphicon glyphicon-home">
                    <a>é¦–é¡µ</a>
                </button>
            </p>
            <button id="btn_blog" type="button"
                    class="btn btn-default btn-lg dropdown-toggle glyphicon glyphicon-list-alt"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                åšå®¢ç®¡ç† <span class="caret"></span>
            </button>
            <ul class="dropdown-menu">
                <li><a href="#">æ–‡ç« ç®¡ç†</a></li>
                <li><a href="#">è¯„è®ºç®¡ç†</a></li>
                <li><a href="#">åšå®¢è®¾ç½®</a></li>
                <li role="separator" class="divider"></li>
                <li><a href="#">åˆ†ç±»ä¸“æ </a></li>
                <li><a href="#">è®¢é˜…ä¸“æ </a></li>
            </ul>
        </div>
    </div>
</nav>
<script>
    check_login()
    $.ajax({
        url: USERURL + localStorage.getItem('pymara_uid') + '/blog_info/',
        type: 'GET',
        datatype: 'json',
        beforeSend: function (request) {
            request.setRequestHeader("pymaratoken", window.localStorage.getItem("pymara_token"));
        },
        success: function (res) {
            if (res.code === 200) {
                if (res.data) {
                    $(".father").html('')
                    for (var i = 0; i < res.data.length; i++) {
                        html = '<div class="article-list-item-mp blog_id_' + res.data[i].id + ' is_show_' + res.data[i].is_show + ' status_' + res.data[i].status + '" >\n' +
                            '                        <div class="list-item-title">\n' +
                            '                            <p class="article-list-item-txt ">\n' +
                            '                                <a href="" target="_blank" title="ç¼–è¾‘">' + res.data[i].title + '</a>\n' +
                            '                            </p>\n' +
                            '                        </div>\n' +
                            '                        <div class="article-list-item-info">\n' +
                            '                            <div class="item-info-left">\n' +
                            '                                <span>åŸåˆ›</span>\n' +
                            '                                <span class="time">' + res.data[i].create_time + '</span>\n' +
                            '                                <span class="article-list-item-read">\n' +
                            '                                <p class="glyphicon glyphicon-book" title="é˜…è¯»é‡">' + res.data[i].browse + '</p></span>\n' +
                            '                                <span class="article-list-item-comments">\n' +
                            '                                <p class="glyphicon glyphicon-comment" title="è¯„è®º">' + res.data[i].comment + '</p></span>\n' +
                            '                                <span class="article-list-item-collection">\n' +
                            '                                <p class="give-a-like glyphicon glyphicon-thumbs-up" title="ç‚¹èµ">' + res.data[i].favorite + '</p></span>\n' +
                            '                            </div>\n' +
                            '                            <div class="item-info-oper">\n' +
                            '                                <a href="" target="_blank" class="item-info-oper-text">\n' +
                            '                                    <span>æŸ¥çœ‹</span>\n' +
                            '                                </a>\n' +
                            '                                <a href="">\n' +
                            '                                    <span class="setTop">ç½®é¡¶</span>\n' +
                            '                                </a>\n' +
                            '                                <a href="javascript:void(0)" id="' + parseInt(res.data[i].id) + '" class="del-blog item-right-border">\n' +
                            '                                    åˆ é™¤' +
                            '                                </a>\n' +
                            '                            </div>\n' +
                            '                        </div>\n' +
                            '                    </div>'

                        $(".father").append(html)
                        if (res.data[i].status === '2') {
                            $('.blog_id_' + res.data[i].id).hide()
                        }
                        if (res.data[i].status === '3') {
                            $('.blog_id_' + res.data[i].id).hide()
                        }
                    }
                }
                $('#huishou>i').html($('.status_3').length)
                $('#gongkai>i').html($('.is_show_1.status_1').length)
                $('#simi>i').html($('.is_show_0.status_1').length)
                $('#quanbu>i').html($('.is_show_1.status_1,.is_show_2.status_1').length)
                $('#caogao>i').html($('.status_2').length)
            } else if (res.code === 403) {
                tools()
            }
        }
    })

</script>
<script>
    $('.father').on('click', '.del-blog', function () {
        blog_id = $(this).attr('id')
        swal({
            title: 'ç¡®å®šåˆ é™¤å—ï¼Ÿ',
            text: 'ä½ å°†æ— æ³•æ¢å¤å®ƒï¼',
            type: 'warning',
            showCancelButton: true,
            confirmButtonColor: '#3085d6',
            cancelButtonColor: '#d33',
            confirmButtonText: 'ç¡®å®šåˆ é™¤ï¼',
        }).then(function () {
            $.ajax({
                url: USERURL + localStorage.getItem('pymara_uid') + '/blog_info/',
                type: 'patch',
                data: JSON.stringify({'blog_id': blog_id}),
                beforeSend: function (request) {
                    request.setRequestHeader("pymaratoken", window.localStorage.getItem("pymara_token"));
                },
                success: function (res) {
                    if (res.code === 200) {
                        $('.blog_id_' + blog_id).hide()
                        swal(
                            'åˆ é™¤ï¼',
                            'ä½ çš„æ–‡ä»¶å·²ç»è¢«åˆ é™¤ã€‚',
                            'success'
                        );
                    }
                }
            })
        })
    })
</script>
<script>
    $(".father").on('click', '.give-a-like', function () {
        console.log('---')
        if ($(this).hasClass('red')) {
            $(this).removeClass('red')
            $(this).text(parseInt($(this).text()) - 1)
        } else {
            $(this).addClass("red")
            $(this).text(parseInt($(this).text()) + 1)
        }
    })
</script>
<script>

    $('#quanbu').on('click', function () {
        $('.article-list-item-mp').hide()
        $('.is_show_1.status_1,.is_show_0.status_1').show()
    })
    $('#gongkai').on('click', function () {
        $('.article-list-item-mp').hide()
        $('.is_show_1.status_1').show()
    })
    $('#simi').on('click', function () {
        console.log('xxx')
        $('.article-list-item-mp').hide()
        // $('.is_show_1').show()
        $('.is_show_0.status_1').show()
    })
    $('#caogao').on('click', function () {
        $('.article-list-item-mp').hide()
        // $('.is_show_0').show()
        // $('.status_1').show()
        $('.status_2').show()
    })
    $('#huishou').on('click', function () {
            $('.article-list-item-mp').hide()
            // $('.is_show_1').show()
            // $('.is_show_0').show()
            $('.status_3').show()
        }
    )
    $('.edit').on('click', function () {
        //ç¼–è¾‘é¡µé¢
        location.href = BLOGHREF+'forms.html'
    })
    $('.home_page').on('click', function () {
        location.href = htmlUrl + 'pymara/templates/index.html'
    })
</script>
</body>
</html>